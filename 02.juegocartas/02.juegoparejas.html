<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Este juegazo de cartas fantastico exprimiera tu memoria al maximo durante horas, bastante de locos" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
        integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="icon" href="favi.png" type="image/png" />
    <link rel="stylesheet" href="css.css">
    <title>Juego de Cartas</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Balsamiq+Sans&family=Bebas+Neue&display=swap');
    </style>
</head>

<body>
    <div class="header">
        <div class="logo">
            <img class="imagenLogo" src="cartas/logo.png">
        </div>
        <div class="titulo">
            <h1 class="esp">Juego de cartas </h1>
            <h1 class="eng">Card game</h1>
        </div>

    </div>
    <hr>

    <div class="puntuacion">
        <div>
            <table>
                <tr>
                    <th width="75px" rowspan="2">
                        <p id="usuario"></p>
                    </th>
                    <th class="cargaIdioma">Puntuación</th>

                    <th class="cargaIdioma">Fallos</th>

                </tr>
                <tr>
                    <th> <i class="fas fa-star-half-alt"></i><input type="text" value="0" id="marcador" disabled
                            size="5"> </th>
                    <th><i class="fas fa-bomb"></i> <input type="text" value="0" id="fallos" disabled size="5"></th>
                </tr>
            </table>
        </div>
        <div class="ranking">
            <table>
                <tr>
                    <th class="cargaIdioma"> Mejor jugador:</th>

                    <th class="cargaIdioma"> Errores mejor jugador:</th>

                </tr>
                <tr>
                    <th id="godplayer"></th>
                    <th id="godmistakes"></th>
                </tr>
            </table>
        </div>
        <div class="idioma">
            <table>
                <tr>
                    <th class="cargaIdioma" colspan="2">Idioma</th>

                </tr>
                <tr>
                    <td><button id="btnESP">ES</button></td>
                    <td><button id="btnENG">EN</button></td>
                </tr>
            </table>
        </div>
    </div>

    <div class="informacion">
        <p id="cargaIdioma">informacion</p>
    </div>
    <div class="jefe">

        <div class="contenedor">

            <div class="cartas" id="carta1"></div>
            <div class="cartas" id="carta2"></div>
            <div class="cartas" id="carta3"></div>
            <div class="cartas" id="carta4"></div>
            <div class="cartas" id="carta5"></div>
            <div class="cartas" id="carta6"></div>
            <div class="cartas" id="carta7"></div>
            <div class="cartas" id="carta8"></div>
            <div class="cartas" id="carta9"></div>
            <div class="cartas" id="carta10"></div>
            <div class="cartas" id="carta11"></div>
            <div class="cartas" id="carta12"></div>
        </div>
        <div id="desc" class="descripcion">
            <p>Esto es un juego de carta para ejercitar la memoria</p>

        </div>
    </div>

    <div class="footer">
        <p>Alberto Samper-Juego de cartas</p>
    </div>



    <script>

        //Cambio de idioma en la descripcion
        document.getElementById("btnESP").addEventListener("click", mostrarDescES);
        document.getElementById("btnENG").addEventListener("click", mostrarDescENG);
        function mostrarDescES() {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("desc").innerHTML = this.responseText;
                }
            };
            xhr.open("GET", "desciripcion.txt", true);
            xhr.send();
        }

        function mostrarDescENG() {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("desc").innerHTML = this.responseText;
                }
            };
            xhr.open("GET", "descripen.txt", true);
            xhr.send();
        }

        let nombreUsuario = document.getElementById('usuario');
        var usuario = prompt("Escribe tu nick: ");
        nombreUsuario.innerHTML = usuario;
        //cambio de idioma xml
        document.getElementById("cargaCatalogo").addEventListener("click", cargarCatalogo);

     
        window.addEventListener('load', function () {
            arrSrc.sort(function () { return Math.random() - 0.5 });
            document.getElementById("godplayer").innerHTML = localStorage.getItem("topUsuario");
            document.getElementById("godmistakes").innerHTML = localStorage.getItem("topErrores");

        });


        let carta1 = document.getElementById('carta1');
        let carta2 = document.getElementById('carta2');
        let carta3 = document.getElementById('carta3');
        let carta4 = document.getElementById('carta4');
        let carta5 = document.getElementById('carta5');
        let carta6 = document.getElementById('carta6');
        let carta7 = document.getElementById('carta7');
        let carta8 = document.getElementById('carta8');
        let carta9 = document.getElementById('carta9');
        let carta10 = document.getElementById('carta10');
        let carta11 = document.getElementById('carta11');
        let carta12 = document.getElementById('carta12');

        let arrCartas = [
            carta1, carta2, carta3, carta4, carta5, carta6,
            carta7, carta8, carta9, carta10, carta11, carta12
        ];

        let arrSrc = [
            "url(cartas/mtg1.jpg)", "url(cartas/mtg2.jpg)", "url(cartas/mtg3.jpg)",
            "url(cartas/mtg4.jpg)", "url(cartas/mtg5.jpg)", "url(cartas/mtg6.jpg)",
            "url(cartas/mtg1.jpg)", "url(cartas/mtg2.jpg)", "url(cartas/mtg3.jpg)",
            "url(cartas/mtg4.jpg)", "url(cartas/mtg5.jpg)", "url(cartas/mtg6.jpg)"
        ];
        let marcador = document.getElementById('marcador');

        let sel1 = '';
        let sel2 = '';


        let errores = document.getElementById("fallos");
        let puntuacion = document.getElementById("marcador");
        puntuacion = 0;
        errores = 0;




        arrCartas[0].addEventListener('click', function () {
            arrCartas[0].style.backgroundImage = arrSrc[0];
        });
        arrCartas[1].addEventListener('click', function () {
            arrCartas[1].style.backgroundImage = arrSrc[1];
        });


        arrCartas[2].addEventListener('click', function () {
            arrCartas[2].style.backgroundImage = arrSrc[2];
        });
        arrCartas[3].addEventListener('click', function () {
            arrCartas[3].style.backgroundImage = arrSrc[3];
        });

        arrCartas[4].addEventListener('click', function () {
            arrCartas[4].style.backgroundImage = arrSrc[4];
        });
        arrCartas[5].addEventListener('click', function () {
            arrCartas[5].style.backgroundImage = arrSrc[5];
        });

        arrCartas[6].addEventListener('click', function () {
            arrCartas[6].style.backgroundImage = arrSrc[6];
        });
        arrCartas[7].addEventListener('click', function () {
            arrCartas[7].style.backgroundImage = arrSrc[7];
        });

        arrCartas[8].addEventListener('click', function () {
            arrCartas[8].style.backgroundImage = arrSrc[8];
        });
        arrCartas[9].addEventListener('click', function () {
            arrCartas[9].style.backgroundImage = arrSrc[9];
        });

        arrCartas[10].addEventListener('click', function () {
            arrCartas[10].style.backgroundImage = arrSrc[10];
        });
        arrCartas[11].addEventListener('click', function () {
            arrCartas[11].style.backgroundImage = arrSrc[11];
        });


        arrCartas.forEach(element => {



            element.addEventListener('click', function comparar(e) {

                if (sel1 == '') {
                    sel1 = e.target;

                } else {
                    if (sel1 == e.target) {

                    } else {
                        sel2 = e.target;
                        if (sel1.style.backgroundImage === sel2.style.backgroundImage) {
                            let info = document.getElementById("informacion");
                            info.innerHTML = "Son pareja";
                            sel1.removeEventListener('click', comparar);
                            sel2.removeEventListener('click', comparar);

                            sel1.style.visibility = 'inherit';
                            sel1.style.visibility = 'inherit';
                            sel1 = '';
                            sel2 = '';
                            puntuacion++;
                            marcador.value = puntuacion;
                            if (marcador.value == 6) {


                                if (localStorage.getItem("topErrores") > errores) {
                                    localStorage.setItem("topUsuario", usuario);
                                    localStorage.setItem("topErrores", errores);

                                    document.getElementById("godplayer").innerHTML = usuario;
                                    document.getElementById("godmistakes").innerHTML = errores;
                                } else {

                                }


                                alert("Has ganado máquina con un total de: " + errores);
                                location.reload();
                            }
                        } else {

                            setTimeout(() => {
                                if (sel1.style.visibility == 'inherit') {
                                    sel2.style.backgroundImage = 'url(cartas/dorso.jpg)';
                                } else if (sel2.style.visibility == 'inherit') {
                                    sel1.style.backgroundImage = 'url(cartas/dorso.jpg)';
                                } else {
                                    sel1.style.backgroundImage = 'url(cartas/dorso.jpg)';
                                    sel2.style.backgroundImage = 'url(cartas/dorso.jpg)';
                                }

                                sel1 = '';
                                sel2 = '';
                                let info = document.getElementById("informacion");
                                info.innerHTML = "no son pareja";
                                errores++;
                                fallos.value = errores;
                            }, 500);
                            //TODO que no se pueda hacer nada mientras se muestran las dos 

                        }
                    }
                }

            })
        });












    </script>
    </div>
</body>

</html>